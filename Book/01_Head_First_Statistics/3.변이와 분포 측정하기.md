## HeadFirst - 3. 변이와 분포 측정하기

평균은 데이터 집합이 가지고 있는 전형적인 값을 알려 주는 데 있어 훌륭한 역할을 수행합니다. 하지만 그렇다고 해서 모든 정보를 제공해 주는 것은 아닙니다. 이 장에선 `범위(range)`와 `변화량(variation)`을 분석함으로써 데이터의 기술을 발전시킬 수 있습니다. 범위나 변화량이 왜 필요할까요? 만약 세명의 농구선수가 있다고 가정합시다. 세 명의 평균득점이 똑같다면 어떤 선수를 뽑아야 할까요? 또 다른 선택 기준이 필요할겁니다. 이 기준 중의 하나가 범위나 변화량이 될 수 있습니다.
<br><br/>


### 1. 범위(Range)

범위는 데이터가 얼마나 많은 숫자 값을 포함하고 있는지 알려줍니다. 이것은 폭을 계산하는 것과 비슷합니다. 범위를 알기 위해선 가장 큰수에서 가장 작은수를 빼면 됩니다. (`상한(upper bound) - 하한(lower bound`)
하지만 범위는 이상치의 영향을 많이 받습니다. (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 100)의 데이터가 있다면 범위는 100-1 = 99입니다. 하지만 대부분의 숫자가 1~10이내에 있는것을 보면 범위가 이 데이터를 대표하기엔 무리가 있어 보입니다. 이런 이상치를 해결하기 위해 사분위수를 사용할 수 있습니다.
<br><br/>


### 2. 사분위수(Quartile)

데이터를 동일한 크기로 4개의 조각으로 나누는 것을 사분위수라고 합니다. 위의 데이터를 적용해보면 (1, 2, 3), (4, 5, 6), (7, 8, 9), (10, 11, 100)이렇게 4개로 나눌 수 있습니다. (1, 2, 3), (4, 5, 6)사이를 `하한 사분위수(lower quartile)` 혹은 `1사분위수(Q1)`이라고 합니다. (4, 5, 6), (7, 8, 9)사이를 `2사분위수(Q2)`이라고 합니다. 다른 말로 중앙값입니다. (7, 8, 9), (10, 11, 100)사이를 `상한 사분위수(upper quartile)` 혹은 `3사분위수(Q3)`라고 합니다. 정리하면 이렇습니다.

(1, 2, 3) Q1 (4, 5, 6) Q2 (7, 8, 9) Q3 (10, 11, 100)

사분위의 범위는 `Q3-Q1`입니다. 따라서 `6.5 - 3.5 = 3`, 즉 3이 사분위의 범위가 됩니다. 이렇게 되면 가운데 50%데이터만을 사용하므로 이상치는 그들의 값이 높든 낮든 상관없이 제외되는 효과를 볼 수 있습니다. 사분위수를 구하는 방법은 다음과 같습니다.

#### 하한 사분위수 찾기

1. 우선 n /4를 계산합니다.
2. 만약 결과가 정수면 하한 사분위수의 위치는 이 정수의 위치값과 그 다음에 오는 값 사이가 됩니다. 두 값의 평균값을 구하면 하한 사분위수를 얻을 수 있습니다.
3. 만약 결과가 정수가 아니면 올림을 합니다. 그러면 하한 사분위수의 위치를 얻을 수 있습니다.

위의 데이터를 적용하면 12/4 = 3 정수가 나오기 때문에 3, 4번 인덱스의 사이가 Q1이 됩니다. 3, 4 사이에 있는 것을 확인할 수 있습니다.

#### 상한 사분위수 찾기

1. 우선 3n/4를 계산합니다.
2. 만약 결과가 정수면 하한 사분위수의 위치는 이 정수의 위치값과 그 다음에 오는 값 사이가 됩니다. 두 값의 평균값을 구하면 하한 사분위수를 얻을 수 있습니다.
3. 만약 결과가 정수가 아니면 올림을 합니다. 그러면 하한 사분위수의 위치를 얻을 수 있습니다.

위의 데이터를 적용하면 3*12/4 = 9 정수가 나오기 때문에 9, 10번째 인덱스의 사이가 Q3이 됩니다. 9, 10사이에 있는 것을 확인할 수 있습니다.
<br><br/>


### 3. 상자그림 (Boxplot)

boxplot은 데이터 집합의 범위, 사분위 범위, 중앙값을 보여줍니다. 동일한 차트 위에 하나 이상의 데이터 집합을 표현할 수 있기 때문에 데이터를 서로 비교하는데 매우 뛰어난 방법입니다.

<img src="https://romanism.github.io/assets/img/statistic/lec01/001.png">

다시 선수얘기로 돌아와봅시다. 범위와 사분범위가 가진 문제점은 그들이 높은 값과 낮은 값에 대해서만 얘기해준다는 것입니다. 저희는 선수가 얼마나 자주 그러한 높은 점수나 낮은 점수를 올리는지, 아니면 가운데에 있는 값에 가까운 점수를 올리는지 여부입니다. 이를 해결하기 해결하기 위해 변화량 개념을 이용합니다.
<br><br/>


### 4. 변이(Variation)

값들이 평균값으로부터 떨어져 있는 거리의 평균을 계산할 수 있다면, 변이와 분포를 측정할 수 있습니다. 결과값이 작을수록 값들은 평균값에 근접해 있는 것입니다. 하지만 문제점이 있습니다. 평균으로 떨어진 거리(편차)를 각각 구해서 더하면 항상 0이 나옵니다. 평균값으로부터 양수 거리와 음수 거리가 서로 상쇄되기 때문입니다. 이러면 수학적으로 의미가 없기 때문에 다른 개념이 필요합니다. 이를 해결하기 위해 나온 개념이 `분산`입니다.
<br><br/>


### 5. 분산(Variance) & 표준편차(Standard deviation)

#### 5.1 분산(Variance)


$$ Var = \frac{\sum (x-\mu)^2}{n} $$


분산의 공식은 각각의 수를 평균과 뺀다음 제곱해서 그 값들을 더합니다. 그리고 데이터의 수만큼 나눠줍니다. 쉽게 말해 제곱을 해서 마이너스를 없애주는 역할을 합니다. 분산이 크다는 것은 그만큼 평균과 거리가 크다는 의미이고 분산이 작다는 것은 평균과의 거리가 작다는 의미입니다.


$$ Var = \frac{\sum x^2}{n}-\mu^2 $$


분산을 쉽게 구하는 방법은 각 데이터들을 제곱한것에 평균을 내고 평균의 제곱을 빼는 방법입니다. 데이터가 많아질수록 이 식이 계산하기 편해집니다.

#### 5.2 표준편차(Standard deviation)

분산이 가진 문제점은 거리를 제곱한 값들이 분포되어 있는 모습을 머리 속에 생각하기 쉽지 않다는 것입니다. 이러한 문제를 해결하기 위한 쉬운 방법이 있씁니다. 분산에 제곱근을 씌우기만 하면 됩니다. 이것을 표준편차라고 합니다.


$$ \sigma = \sqrt{var}$$


표준편차가 작을 수록 값들은 평균값에 더 가깝습니다. 표준편차의 가장 작은 값은 0입니다. 선수관련 문제로 돌아가본다면 분산과 표준편차로 이 사람이 얼마나 득점에 기복이 있는지 없는지 확인할 수 있습니다.
<br><br/>


### 6. 표준점수 (Standard score)

이번엔 다른 문제를 보겠습니다. 평균과 표준편차가 다른 두 데이터가 있는데 이를 어떻게 평가해야 할까요? 이를 해결하기 위해 `표준점수(Standard socre)`, 혹은 `z점수(z-score)`을 이용해서 수행할 수 있습니다. 표준점수를 구하는 공식은 다음과 같습니다.


$$z = \frac{x-\mu}{\sigma}$$


구체적인 예를 들어보겠습니다. 어느 날 연습 시합을 가졌는데 1번 선수는 75%의 슛 성공률, 2번째 선수는 55%의 슛 성공률을 기록했습니다. 1번 선수는 평균이 70, 표준편차가 20이고 2번 선수는 평균이 40, 표준편차가 10입니다. 이 연습 시합에서 평소보다 Performance가 좋았던 선수는 누구일까요? 이럴때 표준 점수를 통한 비교가 가능합니다.

1번 선수의 표준점수는 (75-70)/20 = 0.25이고 2번 선수의 표준점수는 (55-40)/10 = 1.5입니다. 이는 무슨의미일까요? 2번 선수의 표준점수가 1번 선수의 표준점수보다 높기 때문에 이 연습경기에선 2번 선수가 평소보다 좋은 Performance를 냈다고 할 수 있습니다.
